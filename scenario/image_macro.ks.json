[["label",{"name":"start"},0,13,1],["macro",{"name":"begintrans"},0,15,1],["ms",{"off":"true","o2_cond":"f.ghostpia.messageLayerManager.getCurrentValue('endMessage');"},0,16,1],["o2_iscript",{"o2_exp":"\n//\tconsole.group(\"[ghostpia] macro : \"+currentConductor.macroStack[0].definition.name);\n\tf.ghostpia.imageLayerManager.setBeginTrans(true);\n"},0,17,12],["backlay",0,0,21,1],["endmacro",0,0,22,1],["macro",{"name":"endtrans"},0,24,1],["o2_iscript",{"o2_exp":"\n\tf.ghostpia.imageLayerManager.setTransTime(mp.time);\n\tf.ghostpia.imageLayerManager.setTransType(mp.type);\n\tif (mp.wait){\n\t\ttf.tmp.wtcanskip = false;\n\t}else{\n\t\ttf.tmp.wtcanskip = true;\n\t}\n"},0,25,12],["if",{"o2_exp":"typeof f.ghostpia.imageLayerManager.getCurrentValue('transType') != 'undefined'"},0,35,2],["if",{"o2_exp":"typeof f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')) != 'undefined'"},0,41,3],["trans",{"method":"&f.ghostpia.imageLayerManager.getCurrentValue('transType')","rule":"&f.ghostpia.imageLayerManager.getCurrentValue('transRule')","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))"},0,42,4],["else",0,0,43,3],["trans",{"method":"&f.ghostpia.imageLayerManager.getCurrentValue('transType')","rule":"&f.ghostpia.imageLayerManager.getCurrentValue('transRule')","time":"&mp.time","o2_cond":"mp.time"},0,44,4],["trans",{"method":"&f.ghostpia.imageLayerManager.getCurrentValue('transType')","rule":"&f.ghostpia.imageLayerManager.getCurrentValue('transRule')","time":"&f.ghostpia.constant.getValue('transTime')","o2_cond":"!mp.time"},0,45,4],["endif",0,0,46,3],["wt",{"canskip":"&tf.tmp.wtcanskip"},0,47,3],["else",0,0,48,2],["if",{"o2_exp":"typeof f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')) != 'undefined'"},0,54,3],["trans",{"method":"crossfade","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))"},0,55,4],["else",0,0,56,3],["trans",{"method":"crossfade","time":"&mp.time","o2_cond":"mp.time"},0,57,4],["trans",{"method":"crossfade","time":"&f.ghostpia.constant.getValue('transTime')","o2_cond":"!mp.time"},0,58,4],["endif",0,0,59,3],["wt",{"canskip":"&tf.tmp.wtcanskip"},0,60,3],["endif",0,0,61,2],["o2_iscript",{"o2_exp":"\n\tf.ghostpia.imageLayerManager.setBeginTrans(false);\n\tf.ghostpia.imageLayerManager.setTransType(undefined);\n//\tconsole.groupEnd();\n"},0,63,12],["endmacro",0,0,68,1],["macro",{"name":"bank"},0,73,1],["cut",{"id":"%id","storage":"%storage","type":"%type","time":"%time","top":"%top","left":"%left","zoom":"%zoom","opacity":"%opacity","accel":"%accel","all":"%all","del":"%del","wait":"%wait","blur":"%blur","blurx":"%blurx","blury":"%blury","blurmode":"%blurmode","bank":"true","mirror":"%mirror|false"},0,81,1],["endmacro",0,0,107,1],["macro",{"name":"anime"},0,114,1],["o2_iscript",{"o2_exp":"\n\ttf.tmp.imageLayerAnime = true;\n"},0,115,12],["cut",{"id":"%id","storage":"%storage","type":"%type","time":"%time","top":"%top|0","left":"%left|0","zoom":"%zoom","opacity":"%opacity","accel":"%accel","all":"%all","del":"%del","wait":"%wait","blur":"%blur","blurx":"%blurx","blury":"%blury","blurmode":"%blurmode","mirror":"%mirror|false","clipleft":"%clipleft|0","cliptop":"%cliptop|0","clipwidth":"%clipwidth|1138","clipheight":"%clipheight|640"},0,118,1],["endmacro",0,0,141,1],["macro",{"name":"cut"},0,144,1],["if",{"o2_exp":"f.ghostpia.messageLayerManager.getCurrentValue('speaking')"},0,147,1],["o2_iscript",{"o2_exp":"\n\t\ttf.tmp.args = {};\n\t\tfor (var macroKey in mp) {\n\t\t\tif (mp.hasOwnProperty(macroKey)) {\n\t\t\t\ttf.tmp.args[macroKey] = mp[macroKey];\n\t\t\t}\n\t\t}\n\t\ttf.tmp.tagInSpeak[o2.currentMessageLayer.textsProperties.length] = '_cut,'+JSON.stringify(tf.tmp.args)\n\t"},0,149,13],["else",0,0,158,1],["ms",{"off":"true","o2_cond":"f.ghostpia.messageLayerManager.getCurrentValue('endMessage')&&!mp.bank"},0,162,1],["if",{"o2_exp":"mp.del"},0,166,1],["if",{"o2_exp":"mp.all"},0,173,2],["o2_iscript",{"o2_exp":"\n//\t\tconsole.group(\"[ghostpia] macro : \"+currentConductor.macroStack[0].definition.name);\n//\t\t\tconsole.dir(mp);\n//\t\t\tconsole.log(\"all remove\");\n\t\t//delのときwaitがあったら、それは[wt canskip=false]ということである\n\t\t\tif (mp.wait){\n\t\t\t\ttf.tmp.wtcanskip = false;\n\t\t\t}else{\n\t\t\t\ttf.tmp.wtcanskip = true;\n\t\t\t}\n\n\t\t\tf.ghostpia.imageLayerManager.setTransTime(mp.time);\n\t\t\tf.ghostpia.imageLayerManager.setTransType(mp.type);\n\t"},0,174,13],["wm",0,0,189,3],["backlay",{"o2_cond":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans')"},0,191,3],["foreach",{"from":"3","to":"&f.ghostpia.imageLayerManager.getCurrentValue('layerNum')-1"},["num"],193,3],["freeimage",{"layer":"$num","page":"back"},0,194,4],["/",0,0,195,3],["if",{"o2_exp":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans') && typeof f.ghostpia.imageLayerManager.getCurrentValue('transType') != 'undefined'"},0,198,3],["trans",{"method":"&f.ghostpia.imageLayerManager.getCurrentValue('transType')","rule":"&f.ghostpia.imageLayerManager.getCurrentValue('transRule')","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))"},0,204,4],["wt",{"canskip":"&tf.tmp.wtcanskip"},0,205,4],["elsif",{"o2_exp":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans')"},0,206,3],["trans",{"method":"crossfade","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))"},0,212,4],["wt",{"canskip":"&tf.tmp.wtcanskip"},0,213,4],["endif",0,0,214,3],["o2_iscript",{"o2_exp":"\n\t\t\tfor (var i = f.ghostpia.imageLayerManager.getCurrentValue('layerNum'); i > 2; i--) {\n\t\t\t\tif (f.ghostpia.imageLayerManager.getLayCountNumCheck('>')){\n\t\t\t\t\tf.ghostpia.imageLayerManager.removeLayer(i,false);\n\t\t\t\t}else{\n\t\t\t\t\tf.ghostpia.imageLayerManager.removeLayer(i,true);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tf.ghostpia.imageLayerManager.setTransType(undefined);\n//\t\t\tconsole.groupEnd();\n\t\t"},0,217,14],["else",0,0,232,2],["if",{"o2_exp":"f.ghostpia.imageLayerManager.checkUsingId(mp.id)"},0,233,3],["o2_iscript",{"o2_exp":"\n//\t\t\t\tconsole.group(\"[ghostpia] macro : \"+currentConductor.macroStack[0].definition.name);\n//\t\t\t\t\tconsole.dir(mp);\n//\t\t\t\t\tconsole.log(\"remove -> id : \"+mp.id+\" , storage : \"+f.ghostpia.imageLayerManager.getLayerValue('storage',f.ghostpia.imageLayerManager.getLayerNumById(mp.id))+\" , layer : \"+f.ghostpia.imageLayerManager.getLayerNumById(mp.id));\n\n\t\t\t//delのときwaitがあったら、それは[wt canskip=false]ということである\n\t\t\tif (mp.wait){\n\t\t\t\ttf.tmp.wtcanskip = false;\n\t\t\t}else{\n\t\t\t\ttf.tmp.wtcanskip = true;\n\t\t\t}\n\n\t\t\t\tf.ghostpia.imageLayerManager.setActiveLayer(f.ghostpia.imageLayerManager.getLayerNumById(mp.id));\n\t\t\t\tf.ghostpia.imageLayerManager.setTransTime(mp.time);\n\t\t\t\tf.ghostpia.imageLayerManager.setTransType(mp.type);\n\t\t\t\tf.ghostpia.imageLayerManager.setPage(mp.page,\"del\");\n\t\t\t"},0,234,15],["wm",0,0,252,4],["backlay",{"o2_cond":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans')"},0,254,4],["freeimage",{"layer":"&f.ghostpia.imageLayerManager.getLayerNumById(mp.id)","page":"&f.ghostpia.imageLayerManager.getLayerValue('page',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))"},0,255,4],["if",{"o2_exp":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans') && typeof f.ghostpia.imageLayerManager.getCurrentValue('transType') != 'undefined'"},0,257,4],["trans",{"method":"&f.ghostpia.imageLayerManager.getCurrentValue('transType')","rule":"&f.ghostpia.imageLayerManager.getCurrentValue('transRule')","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))"},0,263,5],["wt",{"canskip":"&tf.tmp.wtcanskip"},0,264,5],["elsif",{"o2_exp":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans')"},0,265,4],["trans",{"method":"crossfade","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))"},0,271,5],["wt",{"canskip":"&tf.tmp.wtcanskip"},0,272,5],["endif",0,0,273,4],["o2_iscript",{"o2_exp":"\n\t\t\t\tf.ghostpia.imageLayerManager.setTransType(undefined);\n\t\t\t\tf.ghostpia.imageLayerManager.setOpacity(undefined);\n\t\t\t\tf.ghostpia.imageLayerManager.setLeft(undefined);\n\t\t\t\tf.ghostpia.imageLayerManager.setTop(undefined);\n\t\t\t\tf.ghostpia.imageLayerManager.setZoom(undefined);\n\n\t\t\t\tif (f.ghostpia.imageLayerManager.getLayCountNumCheck('>')){\n\t\t\t\t\tf.ghostpia.imageLayerManager.removeLayer(f.ghostpia.imageLayerManager.getLayerNumById(mp.id),false);\n\t\t\t\t}else{\n\t\t\t\t\tf.ghostpia.imageLayerManager.removeLayer(f.ghostpia.imageLayerManager.getLayerNumById(mp.id),true);\n\t\t\t\t}\n\n//\t\t\t\t\tconsole.dir(f.ghostpia.imageLayerManager.layer);\n//\t\t\t\tconsole.groupEnd();\n\n\t\t\t"},0,275,15],["else",0,0,292,3],["endif",0,0,298,3],["endif",0,0,299,2],["else",0,0,301,1],["o2_iscript",{"o2_exp":"\n\t\tif (isFinite(f.ghostpia.imageLayerManager.getLayerNumById(mp.id)) == true){\n\t\t\t//足りているなら使い回し\n\t\t\tf.ghostpia.imageLayerManager.setActiveLayer(f.ghostpia.imageLayerManager.getLayerNumById(mp.id));\n\n//\t\t\tconsole.group(\"[ghostpia] macro : \"+currentConductor.macroStack[0].definition.name);\n//\t\t\t\tconsole.dir(mp);\n//\t\t\t\tconsole.log(\"renew -> id : \"+mp.id+\" , storage : \"+mp.storage+\" , storage(before) : \"+f.ghostpia.imageLayerManager.getLayerValue('storage',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))+\", layer : \"+f.ghostpia.imageLayerManager.getLayerNumById(mp.id));\n\n\t\t}else{\n\t\t\t//足りていないなら新規追加\n\t\t\tf.ghostpia.imageLayerManager.setActiveLayer(f.ghostpia.imageLayerManager.getNotUsingLayer('autoAdd'));\n\n//\t\t\tconsole.group(\"[ghostpia] macro : \"+currentConductor.macroStack[0].definition.name);\n//\t\t\t\tconsole.dir(mp);\n//\t\t\t\tconsole.log(\"new -> id : \"+mp.id+\" , storage : \"+mp.storage+\" , layer : \"+f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'));\n\t\t}\n\n\t\t//各情報のセット\n\t\tf.ghostpia.imageLayerManager.setId(mp.id);\n\t\tf.ghostpia.imageLayerManager.setLayerIndex(mp.id);\n\t\tf.ghostpia.imageLayerManager.setTransTime(mp.time);\n\t\tf.ghostpia.imageLayerManager.setVisible(mp.visible);\n\t\tf.ghostpia.imageLayerManager.setTransType(mp.type);\n\t\tf.ghostpia.imageLayerManager.setBlur(mp.blur,mp.blurx,mp.blury,mp.blurmode);\n\n\t\t//index値を変更せずにlaycountを行う\n\t\tif (f.ghostpia.imageLayerManager.getLayCountNumCheck('<')){\n\t\t\tfor( var i = o2.foreLayers.imageLayers.length; i < f.ghostpia.imageLayerManager.getCurrentValue('layerNum'); i++ ){\n\t\t\t\to2.foreLayers.imageLayers.push( new ImageLayer() );\n\t\t\t\to2.backLayers.imageLayers.push( new ImageLayer() );\n\t\t\t}\n\t\t\to2.refreshRendererLayers();\n\t\t\trenderer.animator.requestFrame();\n\t\t}\n\n\t"},0,308,13],["if",{"o2_exp":"mp.storage && f.ghostpia.imageLayerManager.getLayerValue('storage',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')) != mp.storage"},0,350,2],["o2_iscript",{"o2_exp":"\n\t\t\tf.ghostpia.imageLayerManager.setPage(mp.page,\"new\");\n\t\t"},0,352,14],["backlay",{"o2_cond":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans')"},0,356,3],["if",{"o2_exp":"tf.tmp.imageLayerAnime"},0,357,3],["image",{"storage":"&mp.storage","layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"&f.ghostpia.imageLayerManager.getLayerValue('page',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","visible":"&f.ghostpia.imageLayerManager.getLayerValue('visible',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","left":"0","top":"0","opacity":"0","fliplr":"%mirror|false","o2_blur":"&f.ghostpia.imageLayerManager.getBlur('o2_blur')","o2_blurx":"&f.ghostpia.imageLayerManager.getBlur('o2_blurX')","o2_blury":"&f.ghostpia.imageLayerManager.getBlur('o2_blurY')","o2_blurmode":"&f.ghostpia.imageLayerManager.getBlur('o2_blurMode')","clipleft":"%clipleft","cliptop":"%cliptop","clipwidth":"%clipwidth","clipheight":"%clipheight","o2_cond":"mp.storage && f.ghostpia.imageLayerManager.getLayerValue('storage',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')) != mp.storage"},0,358,4],["eval",{"o2_exp":"tf.tmp.imageLayerAnime = null"},0,377,4],["else",0,0,378,3],["image",{"storage":"&mp.storage","layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"&f.ghostpia.imageLayerManager.getLayerValue('page',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","visible":"&f.ghostpia.imageLayerManager.getLayerValue('visible',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","left":"0","top":"0","opacity":"0","fliplr":"%mirror|false","o2_blur":"&f.ghostpia.imageLayerManager.getBlur('o2_blur')","o2_blurx":"&f.ghostpia.imageLayerManager.getBlur('o2_blurX')","o2_blury":"&f.ghostpia.imageLayerManager.getBlur('o2_blurY')","o2_blurmode":"&f.ghostpia.imageLayerManager.getBlur('o2_blurMode')","o2_cond":"mp.storage && f.ghostpia.imageLayerManager.getLayerValue('storage',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')) != mp.storage"},0,379,4],["endif",0,0,394,3],["layopt",{"layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"&f.ghostpia.imageLayerManager.getLayerValue('page',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","visible":"&f.ghostpia.imageLayerManager.getLayerValue('visible',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","left":"&f.ghostpia.imageLayerManager.getLeft(mp.left,'from')","top":"&f.ghostpia.imageLayerManager.getTop(mp.top,'from')","opacity":"&f.ghostpia.imageLayerManager.getOpacity(mp.opacity,'from')","index":"&f.ghostpia.imageLayerManager.getLayerIndex()","o2_zoom":"&f.ghostpia.imageLayerManager.getZoom(mp.zoom,'from')"},0,395,3],["o2_forelay",{"o2_cond":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans') && !mp.type"},0,411,3],["if",{"o2_exp":"f.ghostpia.imageLayerManager.checkMoving(f.ghostpia.imageLayerManager.getOpacity(mp.opacity,'from')) || f.ghostpia.imageLayerManager.checkMoving(mp.top) || f.ghostpia.imageLayerManager.checkMoving(mp.left)"},0,413,3],["move",{"layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"fore","spline":"false","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","delay":"0","o2_path":"&f.ghostpia.imageLayerManager.getMovePath(mp.left,mp.top,mp.opacity,mp.zoom)","accel":"&f.ghostpia.imageLayerManager.getAccel(mp.accel)"},0,414,4],["move",{"layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"back","spline":"false","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","delay":"0","o2_path":"&f.ghostpia.imageLayerManager.getMovePath(mp.left,mp.top,mp.opacity,mp.zoom)","accel":"&f.ghostpia.imageLayerManager.getAccel(mp.accel)"},0,423,4],["o2_iscript",{"o2_exp":"\n//\t\t\t\tconsole.log(\"move -> path : \"+f.ghostpia.imageLayerManager.getMovePath(mp.left,mp.top,mp.opacity,mp.zoom)+\" , accel : \"+f.ghostpia.imageLayerManager.getAccel(mp.accel)+\" , time : \"+f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')));\n\n\t\t\t\t//suzume 0821 レイヤーindex値が正しく反映できない問題 → ここにリフレッシュを入れると改善できるようです\n\t\t\t\to2.refreshRendererLayers();\n\t\t\t\trenderer.animator.requestFrame();\n\t\t\t"},0,432,15],["if",{"o2_exp":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans') && typeof f.ghostpia.imageLayerManager.getCurrentValue('transType') != 'undefined'"},0,440,4],["trans",{"method":"&f.ghostpia.imageLayerManager.getCurrentValue('transType')","rule":"&f.ghostpia.imageLayerManager.getCurrentValue('transRule')","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))"},0,446,5],["wt",0,0,447,5],["endif",0,0,448,4],["endif",0,0,450,3],["else",0,0,456,2],["o2_iscript",{"o2_exp":"\n\t\t\tf.ghostpia.imageLayerManager.setPage(mp.page,\"move\");\n\t\t"},0,458,14],["image",{"storage":"&f.ghostpia.imageLayerManager.getLayerValue('storage',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"&f.ghostpia.imageLayerManager.getLayerValue('page',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","visible":"&f.ghostpia.imageLayerManager.getLayerValue('visible',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","left":"400","top":"400","opacity":"0","o2_blur":"&f.ghostpia.imageLayerManager.getBlur('o2_blur')","o2_blurx":"&f.ghostpia.imageLayerManager.getBlur('o2_blurX')","o2_blury":"&f.ghostpia.imageLayerManager.getBlur('o2_blurY')","o2_blurmode":"&f.ghostpia.imageLayerManager.getBlur('o2_blurMode')","o2_cond":"mp.blur||mp.blurx||mp.blury||mp.blurmode"},0,462,3],["layopt",{"layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"&f.ghostpia.imageLayerManager.getLayerValue('page',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","visible":"&f.ghostpia.imageLayerManager.getLayerValue('visible',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","left":"&f.ghostpia.imageLayerManager.getLeft(mp.left,'from')","top":"&f.ghostpia.imageLayerManager.getTop(mp.top,'from')","opacity":"&f.ghostpia.imageLayerManager.getOpacity(mp.opacity,'from')","index":"&f.ghostpia.imageLayerManager.getLayerIndex()","o2_zoom":"&f.ghostpia.imageLayerManager.getZoom(mp.zoom,'from')"},0,477,3],["backlay",{"o2_cond":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans')"},0,487,3],["if",{"o2_exp":"f.ghostpia.imageLayerManager.checkMoving(f.ghostpia.imageLayerManager.getOpacity(mp.opacity,'from')) || f.ghostpia.imageLayerManager.checkMoving(mp.top) || f.ghostpia.imageLayerManager.checkMoving(mp.left) || typeof mp.rotate !== 'undefined'"},0,494,3],["move",{"layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"fore","spline":"false","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","delay":"0","o2_path":"&f.ghostpia.imageLayerManager.getMovePath(mp.left,mp.top,mp.opacity,mp.zoom,mp.rotate)","accel":"&f.ghostpia.imageLayerManager.getAccel(mp.accel)"},0,495,4],["move",{"layer":"&f.ghostpia.imageLayerManager.getCurrentValue('activeLayer')","page":"back","spline":"false","time":"&f.ghostpia.imageLayerManager.getLayerValue('transTime',f.ghostpia.imageLayerManager.getCurrentValue('activeLayer'))","delay":"0","o2_path":"&f.ghostpia.imageLayerManager.getMovePath(mp.left,mp.top,mp.opacity,mp.zoom,mp.rotate)","accel":"&f.ghostpia.imageLayerManager.getAccel(mp.accel)"},0,504,4],["endif",0,0,518,3],["endif",0,0,520,2],["o2_iscript",{"o2_exp":"\n\t\tf.ghostpia.imageLayerManager.setTransType(undefined);\n\t\tf.ghostpia.imageLayerManager.setStorage(mp.storage);\n\t\tf.ghostpia.imageLayerManager.setOpacity(f.ghostpia.imageLayerManager.getOpacity(mp.opacity,'to',true));\n\t\tf.ghostpia.imageLayerManager.setLeft(f.ghostpia.imageLayerManager.getLeft(mp.left,'to',true));\n\t\tf.ghostpia.imageLayerManager.setTop(f.ghostpia.imageLayerManager.getTop(mp.top,'to',true));\n\n//\t\tconsole.groupEnd();\n\t"},0,527,13],["wm",{"o2_cond":"mp.wait"},0,538,3],["endif",0,0,540,1],["endif",0,0,544,1],["endmacro",0,0,546,1],["macro",{"name":"背景"},0,550,1],["ms",{"off":"true","o2_cond":"f.ghostpia.messageLayerManager.getCurrentValue('endMessage');"},0,551,2],["o2_iscript",{"o2_exp":"\n\t\tf.ghostpia.baseLayerManager.setDiff(mp.diff,mp.name);\n\t\tf.ghostpia.baseLayerManager.setPage(mp.page,mp.storage);\n\t\tf.ghostpia.baseLayerManager.setVisible(mp.visible);\n\t\tf.ghostpia.baseLayerManager.setTransTime(mp.time);\n\t\tf.ghostpia.baseLayerManager.setTransType(mp.type);\n\t\tf.ghostpia.baseLayerManager.setBlur(mp.blur,mp.blurx,mp.blury,mp.blurmode);\n\n\t\t//waitがあったら、それは[wt canskip=false]ということである\n\t\tif (mp.wait){\n\t\t\ttf.tmp.wtcanskip = false;\n\t\t}else{\n\t\t\ttf.tmp.wtcanskip = true;\n\t\t}\n//\t\tconsole.group(\"[ghostpia] macro : \"+currentConductor.macroStack[0].definition.name+\" (背景)\");\n//\t\t\tconsole.dir(mp);\n//\t\t\tconsole.log(\"storage : \"+f.ghostpia.baseLayerManager.getStorage(mp.storage)+\" , layer : base , transType : \"+f.ghostpia.baseLayerManager.getCurrentValue('transType')+\", rule : \"+f.ghostpia.baseLayerManager.getCurrentValue('transRule')+\", time : \"+f.ghostpia.baseLayerManager.getCurrentValue('transTime'));\n\n\t"},0,552,13],["backlay",0,0,571,2],["if",{"o2_exp":"mp.storage"},0,572,2],["image",{"storage":"&f.ghostpia.baseLayerManager.getStorage(mp.storage)","layer":"base","page":"&f.ghostpia.baseLayerManager.getCurrentValue('page')","visible":"&f.ghostpia.baseLayerManager.getCurrentValue('visible')","left":"0","top":"0","opacity":"255","o2_blur":"&f.ghostpia.baseLayerManager.getCurrentValue('o2_blur')","o2_blurx":"&f.ghostpia.baseLayerManager.getCurrentValue('o2_blurX')","o2_blury":"&f.ghostpia.baseLayerManager.getCurrentValue('o2_blurY')","o2_blurmode":"&f.ghostpia.baseLayerManager.getCurrentValue('o2_blurMode')"},0,573,3],["layopt",{"layer":"base","page":"&f.ghostpia.baseLayerManager.getCurrentValue('page')","visible":"&f.ghostpia.baseLayerManager.getCurrentValue('visible')","left":"&f.ghostpia.baseLayerManager.getLeft(mp.left,'from')","top":"&f.ghostpia.baseLayerManager.getTop(mp.top,'from')","opacity":"&f.ghostpia.baseLayerManager.getOpacity(mp.opacity,'to')"},0,584,3],["if",{"o2_exp":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans')"},0,592,3],["trans",{"method":"&f.ghostpia.baseLayerManager.getCurrentValue('transType')","rule":"&f.ghostpia.baseLayerManager.getCurrentValue('transRule')","time":"&f.ghostpia.baseLayerManager.getCurrentValue('transTime')"},0,593,4],["wt",{"canskip":"&tf.tmp.wtcanskip"},0,594,4],["endif",0,0,595,3],["else",0,0,596,2],["layopt",{"layer":"base","page":"&f.ghostpia.baseLayerManager.getCurrentValue('page')","visible":"&f.ghostpia.baseLayerManager.getCurrentValue('visible')","left":"&f.ghostpia.baseLayerManager.getLeft(mp.left,'from')","top":"&f.ghostpia.baseLayerManager.getTop(mp.top,'from')","opacity":"&f.ghostpia.baseLayerManager.getOpacity(mp.opacity,'from')"},0,597,3],["if",{"o2_exp":"!f.ghostpia.imageLayerManager.getCurrentValue('beginTrans')"},0,605,3],["o2_forelay",0,0,606,4],["endif",0,0,607,3],["endif",0,0,608,2],["if",{"o2_exp":"f.ghostpia.baseLayerManager.checkMoving(mp.top) || f.ghostpia.baseLayerManager.checkMoving(mp.left)"},0,610,2],["move",{"layer":"base","page":"fore","spline":"false","time":"&f.ghostpia.baseLayerManager.getCurrentValue('transTime')","delay":"0","path":"&f.ghostpia.baseLayerManager.getMovePath(mp.left,mp.top,mp.opacity)","accel":"&f.ghostpia.baseLayerManager.getAccel(mp.accel)"},0,611,3],["move",{"layer":"base","page":"back","spline":"false","time":"&f.ghostpia.baseLayerManager.getCurrentValue('transTime')","delay":"0","path":"&f.ghostpia.baseLayerManager.getMovePath(mp.left,mp.top,mp.opacity)","accel":"&f.ghostpia.baseLayerManager.getAccel(mp.accel)"},0,620,3],["wm",0,0,634,3],["endif",0,0,635,2],["o2_iscript",{"o2_exp":"\n\n\t\tf.ghostpia.baseLayerManager.setStorage(mp.storage)\n\t\tf.ghostpia.baseLayerManager.setOpacity(f.ghostpia.baseLayerManager.getOpacity(mp.opacity,'to',true));\n\t\tf.ghostpia.baseLayerManager.setLeft(f.ghostpia.baseLayerManager.getLeft(mp.left,'to',true));\n\t\tf.ghostpia.baseLayerManager.setTop(f.ghostpia.baseLayerManager.getTop(mp.top,'to',true));\n\n//\t\tconsole.groupEnd();\n\t"},0,637,13],["endmacro",0,0,646,1],["eval",{"o2_exp":"tf.tmp.cnt = 0;"},0,651,1],["call",{"target":"*bg_sub"},0,652,1],["macro",{"name":"bg"},0,653,1],["背景",{"storage":"&f.ghostpia.baseLayerManager.getBgStorage(mp.name)","diff":"%diff","type":"%type","time":"%time","left":"%left","top":"%top","accel":"%accel","page":"%page","visible":"%visible","opacity":"%opacity","name":"%name","blur":"%blur","blurx":"%blurx","blury":"%blury","blurmode":"%blurmode"},0,654,2],["endmacro",0,0,655,1],["return",0,0,657,1],["label",{"name":"bg_sub"},0,659,1],["macro",{"name":"&f.ghostpia.baseLayerManager.getBgName(tf.tmp.cnt)"},0,660,1],["bg",{"*":"true","name":"&currentConductor.macroStack[currentConductor.macroStack.length-1].definition.name","diff":"%diff","type":"%type","time":"%time","left":"%left","top":"%top","accel":"%accel","page":"%page","visible":"%visible","opacity":"%opacity"},0,665,2],["endmacro",0,0,666,1],["eval",{"o2_exp":"tf.tmp.cnt++"},0,667,1],["jump",{"target":"*bg_sub","o2_cond":"tf.tmp.cnt < f.ghostpia.baseLayerManager.getBgListlength()"},0,668,1],["return",0,0,669,1]]